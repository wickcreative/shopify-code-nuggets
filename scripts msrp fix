# FIND THIS
#  def apply(line_item)
#    line_item.change_line_price(line_item.line_price * @discount, message: @message)
#  end  
# CHANGE TO THIS
	def apply(line_item)
   # puts line_item.variant.inspect
    if line_item.variant.instance_variable_defined?(:@compare_at_price)
        line_price = line_item.variant.compare_at_price * line_item.quantity
    else
        line_price = line_item.line_price
    end
    line_item.change_line_price(line_price * @discount, message: @message)
  end
